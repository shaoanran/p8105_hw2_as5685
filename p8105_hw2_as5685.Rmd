---
title: "P8105_hw2_as5685"
output: github_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```
# problem 1
## import datasets 
```{r}
waterwheel_data =
  read_excel(path = "~/Desktop/Data Science/p8105_hw2_as5685/Trash-wheel-collection-totals-8-6-19.xlsx","Mr. Trash Wheel", range = ("A2:N408")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```


##clean precipitation data for 2017 and 2018
```{r}
precipitation2017_data =
  read_excel(path = "~/Desktop/Data Science/p8105_hw2_as5685/Trash-wheel-collection-totals-8-6-19.xlsx","2017 Precipitation", range = "A2:B14") %>%
    janitor::clean_names() %>%
    drop_na() %>% 
    mutate(year = "2017")
    
precipitation2018_data =
  read_excel(path = "~/Desktop/Data Science/p8105_hw2_as5685/Trash-wheel-collection-totals-8-6-19.xlsx","2018 Precipitation", range = "A2:B14") %>% 
    janitor::clean_names() %>%
    drop_na() %>% 
    mutate(year = "2018")


PrecipitationsCombined_data =
bind_rows(precipitation2017_data, precipitation2018_data) %>% 
  mutate(
    month = month.name[month]
  )
```
Interpretation about the data: 
The total precipitation in 2018 is `r sum(pull(precipitation2018_data,total))`.
The median number of sports balls in a dumpster in 217 is `r median(pull(filter(waterwheel_data,year == 2017),sports_balls))`. waterwheel_data =

The number of observation in waterwheel_data is `r nrow(waterwheel_data)`.
The number of observation in merged data for 2017/2018 precipitation is `r nrow(PrecipitationsCombined_data)`.
In the dataset "PrecipitationsCombined_data", the colomn "total" is key variable which shows the total precipitation in each month of each year. Such as total precipitation is 2.34 inches in January 2017. This variables is related to the some variables in dataset "waterwheel_data", such as "dumpsters". If the total precipitation is large, then usually, the total number of dumpster filled will also be increased. So we can explore the relationship between them. 


# problem2
## read in Fivethirtyeight
```{r}
pols_month_data = read_csv("./fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon,into = c("year","month", "day"),sep = "-") %>% 
  pivot_longer(
    cols = starts_with("prez"),
    names_to = "prezsident", 
    names_prefix = "prez_",
    values_to = "value"
  ) %>% 
filter(value != "0") %>% 
select(-day)

snp_data = read_csv("./fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date,into = c("month","day", "year"),sep = "/") %>% 
  select(year, month, -day, close)


unemployment_data = read_csv("./fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    year = as.character(year) 
  ) %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "rate"
    )
```

## merge 2017,2018 and unemployment  
```{r}
merged_data =
  left_join(pols_month_data,snp_data,by = c("year","month"))
merged_three_data = 
  left_join(merged_data, unemployment_data, by = c("year","month"))
```

# problem 3
## load and tidy NYC Open data 
```{r}
baby_names_data = read_csv("./Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    gender = str_to_lower(gender),
    childs_first_name = str_to_lower(childs_first_name),
    ethnicity = str_to_lower(ethnicity),
    ethnicity = replace(ethnicity, ethnicity == "asian and paci", "asian and pacific islander"),
    ethnicity = replace(ethnicity, ethnicity == "black non hisp", "black non hispanic"),
    ethnicity = replace(ethnicity, ethnicity == "white non hisp", "white non hispanic")
  ) %>% 

distinct()
```


## rank "Olivia"
```{r}
olivia_rank = filter(baby_names_data, childs_first_name == "olivia", gender == "female") %>% 
arrange(rank,year_of_birth) %>% 
select(year_of_birth, rank,ethnicity) %>% 

pivot_wider(
  names_from = "year_of_birth",
  values_from = "rank"
) 

```

## rank boy's popular name
```{r}
male_name_rank = filter(baby_names_data, gender == "male", rank == "1") %>% 
select(year_of_birth,ethnicity,childs_first_name) %>% 
pivot_wider(
  names_from = "year_of_birth",
  values_from = "childs_first_name"
) 
```

## plots for the number of children against the rank
```{r}
plot_data = filter(baby_names_data, gender == "male", ethnicity == "white non hispanic", year_of_birth == "2016") %>% 
  ggplot(aes(x = rank, y = count)) + geom_point()

```




